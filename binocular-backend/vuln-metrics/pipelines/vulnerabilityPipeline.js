import { persistVersionChanges } from './persistVersionChanges.js';
import { enrichVersionChanges } from './enrichVersionChanges.js';

export async function runVulnerabilityEnrichment(repo, currentBranch) {
  console.log('=== Vulnerability Enrichment Pipeline Started ===');

  try {
    console.log('[1/2] Persisting version change events...');
    await persistVersionChanges(repo, currentBranch);
    console.log('[1/2] Done.');

    console.log('[2/2] Enriching version change events with vulnerability data...');
    await enrichVersionChanges();
    console.log('[2/2] Done.');

    console.log('=== Vulnerability Enrichment Pipeline Completed ===');
  } catch (error) {
    console.error('Vulnerability enrichment pipeline failed:', error);
  }
}
